<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–§–∏–Ω–∞–Ω—Å—ã</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ -->
    <div id="sync-status" class="sync-status hidden">
        <span class="sync-icon">‚òÅÔ∏è</span>
        <span class="sync-text">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...</span>
    </div>

    <!-- –í–µ–ª–∫–æ–º —ç–∫—Ä–∞–Ω -->
    <div id="welcome-screen" class="welcome-screen">
        <div class="welcome-logo">üí∞</div>
        <h1 class="welcome-title">–ú–æ–∏ —Ñ–∏–Ω–∞–Ω—Å—ã</h1>
        <p class="welcome-subtitle">–£–º–Ω—ã–π —É—á—ë—Ç –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø—Ä—è–º–æ –≤ Telegram</p>
        
        <div class="welcome-features">
            <div class="feature-item">
                <span class="feature-icon">üìä</span>
                <span>–£—á—ë—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</span>
            </div>
            <div class="feature-item">
                <span class="feature-icon">üí≥</span>
                <span>–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—á–µ—Ç–∞</span>
            </div>
            <div class="feature-item">
                <span class="feature-icon">üìà</span>
                <span>–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
            </div>
            <div class="feature-item">
                <span class="feature-icon">‚òÅÔ∏è</span>
                <span>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ –æ–±–ª–∞–∫–µ</span>
            </div>
        </div>
        
        <button class="welcome-btn" onclick="startApp()">–ù–∞—á–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è</button>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="main-app" class="main-app">
        <div class="container">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –±–∞–ª–∞–Ω—Å–æ–º -->
            <div class="header">
                <h1>–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</h1>
                <div class="total-balance" id="total-balance">0 ‚ÇΩ</div>
                <div class="accounts-summary" id="accounts-summary"></div>
            </div>

            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
            <div id="add-tab" class="tab-content">
                <div class="form-section">
                    <div class="form-group">
                        <label>–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</label>
                        <select id="type" onchange="updateCategories()">
                            <option value="expense">–†–∞—Å—Ö–æ–¥</option>
                            <option value="income">–î–æ—Ö–æ–¥</option>
                            <option value="transfer">–ü–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–°—É–º–º–∞</label>
                        <input type="number" id="amount" placeholder="0">
                    </div>

                    <div id="category-group" class="form-group">
                        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        <select id="category">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        </select>
                    </div>

                    <div id="from-account-group" class="form-group hidden">
                        <label>–°–æ —Å—á—ë—Ç–∞</label>
                        <select id="from-account"></select>
                    </div>

                    <div id="to-account-group" class="form-group hidden">
                        <label>–ù–∞ —Å—á—ë—Ç</label>
                        <select id="to-account"></select>
                    </div>

                    <div id="account-group" class="form-group">
                        <label>–°—á—ë—Ç</label>
                        <select id="account">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á—ë—Ç</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                        <input type="text" id="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏">
                    </div>

                    <button class="btn" onclick="addTransaction()">–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</button>
                </div>
            </div>

            <!-- –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π -->
            <div id="history-tab" class="tab-content hidden">
                <div class="filters">
                    <div class="filter-row">
                        <select id="period-filter">
                            <option value="all">–ó–∞ –≤—Å—ë –≤—Ä–µ–º—è</option>
                            <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
                            <option value="week">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</option>
                            <option value="month">–ü–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü</option>
                            <option value="quarter">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞</option>
                            <option value="calendar">–í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É</option>
                        </select>
                        <select id="category-filter">
                            <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        </select>
                    </div>
                    
                    <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤—ã–±–æ—Ä–∞ –¥–∞—Ç -->
                    <div id="calendar-date-range" class="hidden">
                        <div class="date-mode-toggle">
                            <button type="button" class="date-mode-btn active" onclick="setDateMode('single')">–î–∞—Ç–∞</button>
                            <button type="button" class="date-mode-btn" onclick="setDateMode('range')">–ü–µ—Ä–∏–æ–¥</button>
                        </div>
                        <div class="calendar-container">
                            <div class="calendar-header">
                                <button type="button" class="calendar-nav-btn" onclick="changeMonth(-1)">‚Äπ</button>
                                <div class="calendar-month-year" id="calendar-month-year">–Ø–Ω–≤–∞—Ä—å 2024</div>
                                <button type="button" class="calendar-nav-btn" onclick="changeMonth(1)">‚Ä∫</button>
                            </div>
                            <div class="calendar-grid">
                                <div class="calendar-day-header">–ü–Ω</div>
                                <div class="calendar-day-header">–í—Ç</div>
                                <div class="calendar-day-header">–°—Ä</div>
                                <div class="calendar-day-header">–ß—Ç</div>
                                <div class="calendar-day-header">–ü—Ç</div>
                                <div class="calendar-day-header">–°–±</div>
                                <div class="calendar-day-header">–í—Å</div>
                                <div id="calendar-days"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="filter-row">
                        <select id="type-filter">
                            <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
                            <option value="income">–î–æ—Ö–æ–¥—ã</option>
                            <option value="expense">–†–∞—Å—Ö–æ–¥—ã</option>
                            <option value="transfer">–ü–µ—Ä–µ–≤–æ–¥—ã</option>
                        </select>
                        <select id="account-filter">
                            <option value="all">–í—Å–µ —Å—á–µ—Ç–∞</option>
                        </select>
                    </div>
                    <button class="btn secondary clear-filters" onclick="clearFilters()">–û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                </div>
                
                <div class="transaction-list" id="transaction-list">
                    <div class="empty-state">
                        <p>–û–ø–µ—Ä–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
                    </div>
                </div>
            </div>

            <!-- –°—á–µ—Ç–∞ -->
            <div id="accounts-tab" class="tab-content hidden">
                <div class="accounts-grid" id="accounts-grid"></div>
                
                <div class="form-section">
                    <h3 style="margin-bottom: 16px;">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å—á—ë—Ç</h3>
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å—á—ë—Ç–∞</label>
                        <input type="text" id="new-account-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–±–µ—Ä–µ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Å—á—ë—Ç">
                    </div>
                    <div class="form-group">
                        <label>–ò–∫–æ–Ω–∫–∞</label>
                        <select id="new-account-icon">
                            <option value="üíµ">üíµ</option>
                            <option value="üí≥">üí≥</option>
                            <option value="üè¶">üè¶</option>
                            <option value="üìä">üìä</option>
                            <option value="üê∑">üê∑</option>
                            <option value="üí∞">üí∞</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å</label>
                        <input type="number" id="new-account-balance" placeholder="0">
                    </div>
                    <button class="btn" onclick="addAccount()">–î–æ–±–∞–≤–∏—Ç—å —Å—á—ë—Ç</button>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ -->
            <div id="categories-tab" class="tab-content hidden">
                <div class="category-management">
                    <h3 style="margin-bottom: 16px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h3>
                    
                    <div class="category-list" id="category-list"></div>
                    
                    <div class="form-group">
                        <label>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</label>
                        <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                            <input type="text" id="new-category-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏" style="flex: 1;">
                            <select id="new-category-type" style="width: 120px;">
                                <option value="expense">–†–∞—Å—Ö–æ–¥</option>
                                <option value="income">–î–æ—Ö–æ–¥</option>
                            </select>
                        </div>
                        
                        <div class="icon-selection-container">
                            <button type="button" class="icon-toggle-btn" onclick="toggleIconSelection()">
                                –í—ã–±—Ä–∞—Ç—å –∏–∫–æ–Ω–∫—É: <span id="selected-icon-display">üì¶</span>
                            </button>
                            <div id="icon-grid-container" class="hidden">
                                <div class="icon-grid" id="icon-grid"></div>
                            </div>
                        </div>
                    </div>
                    <button class="btn" onclick="addCategory()">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div id="stats-tab" class="tab-content hidden">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-income" style="color: #4CAF50;">0 ‚ÇΩ</div>
                        <div class="stat-label">–î–æ—Ö–æ–¥—ã</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-expenses" style="color: #f44336;">0 ‚ÇΩ</div>
                        <div class="stat-label">–†–∞—Å—Ö–æ–¥—ã</div>
                    </div>
                </div>

                <div class="category-stats">
                    <h3 style="margin-bottom: 16px;">–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                    <div id="expense-breakdown"></div>
                </div>

                <div class="category-stats">
                    <h3 style="margin-bottom: 16px;">–î–æ—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                    <div id="income-breakdown"></div>
                </div>

                <div class="category-stats">
                    <h3 style="margin-bottom: 16px;">–ë–∞–ª–∞–Ω—Å—ã —Å—á–µ—Ç–æ–≤</h3>
                    <div id="accounts-breakdown"></div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
        <div id="edit-modal" class="modal hidden">
            <div class="modal-overlay" onclick="closeEditModal()"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</h3>
                    <button class="modal-close" onclick="closeEditModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</label>
                        <select id="edit-type" onchange="updateEditCategories()">
                            <option value="expense">–†–∞—Å—Ö–æ–¥</option>
                            <option value="income">–î–æ—Ö–æ–¥</option>
                            <option value="transfer">–ü–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–°—É–º–º–∞</label>
                        <input type="number" id="edit-amount" placeholder="0">
                    </div>

                    <div id="edit-category-group" class="form-group">
                        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        <select id="edit-category">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        </select>
                    </div>

                    <div id="edit-from-account-group" class="form-group hidden">
                        <label>–°–æ —Å—á—ë—Ç–∞</label>
                        <select id="edit-from-account"></select>
                    </div>

                    <div id="edit-to-account-group" class="form-group hidden">
                        <label>–ù–∞ —Å—á—ë—Ç</label>
                        <select id="edit-to-account"></select>
                    </div>

                    <div id="edit-account-group" class="form-group">
                        <label>–°—á—ë—Ç</label>
                        <select id="edit-account">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á—ë—Ç</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                        <input type="text" id="edit-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏">
                    </div>

                    <div class="btn-group">
                        <button class="btn secondary back-btn" onclick="closeEditModal()">–ù–∞–∑–∞–¥</button>
                        <button class="btn" onclick="saveEditTransaction()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—á–µ—Ç–∞ -->
        <div id="edit-account-modal" class="modal hidden">
            <div class="modal-overlay" onclick="closeEditAccountModal()"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—á—ë—Ç</h3>
                    <button class="modal-close" onclick="closeEditAccountModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å—á—ë—Ç–∞</label>
                        <input type="text" id="edit-account-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å—á—ë—Ç–∞">
                    </div>
                    
                    <div class="form-group">
                        <label>–ò–∫–æ–Ω–∫–∞</label>
                        <select id="edit-account-icon">
                            <option value="üíµ">üíµ</option>
                            <option value="üí≥">üí≥</option>
                            <option value="üè¶">üè¶</option>
                            <option value="üìä">üìä</option>
                            <option value="üê∑">üê∑</option>
                            <option value="üí∞">üí∞</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <div class="balance-input-group">
                            <label class="balance-input-label">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å</label>
                            <input type="number" id="account-new-balance" placeholder="0" step="0.01">
                            <div class="current-balance-display">
                                –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: <span id="current-balance-amount">0 ‚ÇΩ</span>
                            </div>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button class="btn secondary back-btn" onclick="closeEditAccountModal()">–ù–∞–∑–∞–¥</button>
                        <button class="btn" onclick="saveEditAccount()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∏–∂–Ω–µ–µ –º–µ–Ω—é -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="showTab('add')">
                <div class="nav-icon">‚ûï</div>
                <div class="nav-label">–î–æ–±–∞–≤–∏—Ç—å</div>
            </div>
            <div class="nav-item" onclick="showTab('history')">
                <div class="nav-icon">üìã</div>
                <div class="nav-label">–ò—Å—Ç–æ—Ä–∏—è</div>
            </div>
            <div class="nav-item" onclick="showTab('accounts')">
                <div class="nav-icon">üí≥</div>
                <div class="nav-label">–°—á–µ—Ç–∞</div>
            </div>
            <div class="nav-item" onclick="showTab('categories')">
                <div class="nav-icon">üè∑Ô∏è</div>
                <div class="nav-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
            </div>
            <div class="nav-item" onclick="showTab('stats')">
                <div class="nav-icon">üìä</div>
                <div class="nav-label">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
            </div>
        </div>
    </div>
<script src="js/script.js"></script>
</body>
</html>
